{"ast":null,"code":"\"use strict\";\n\nconst vm = require(\"vm\");\nconst webIDLConversions = require(\"webidl-conversions\");\nconst {\n  CSSStyleDeclaration\n} = require(\"cssstyle\");\nconst {\n  Performance: RawPerformance\n} = require(\"w3c-hr-time\");\nconst notImplemented = require(\"./not-implemented\");\nconst {\n  installInterfaces\n} = require(\"../living/interfaces\");\nconst {\n  define,\n  mixin\n} = require(\"../utils\");\nconst Element = require(\"../living/generated/Element\");\nconst EventTarget = require(\"../living/generated/EventTarget\");\nconst EventHandlerNonNull = require(\"../living/generated/EventHandlerNonNull\");\nconst OnBeforeUnloadEventHandlerNonNull = require(\"../living/generated/OnBeforeUnloadEventHandlerNonNull\");\nconst OnErrorEventHandlerNonNull = require(\"../living/generated/OnErrorEventHandlerNonNull\");\nconst PageTransitionEvent = require(\"../living/generated/PageTransitionEvent\");\nconst namedPropertiesWindow = require(\"../living/named-properties-window\");\nconst postMessage = require(\"../living/post-message\");\nconst DOMException = require(\"domexception/webidl2js-wrapper\");\nconst {\n  btoa,\n  atob\n} = require(\"abab\");\nconst idlUtils = require(\"../living/generated/utils\");\nconst WebSocketImpl = require(\"../living/websockets/WebSocket-impl\").implementation;\nconst BarProp = require(\"../living/generated/BarProp\");\nconst documents = require(\"../living/documents.js\");\nconst External = require(\"../living/generated/External\");\nconst Navigator = require(\"../living/generated/Navigator\");\nconst Performance = require(\"../living/generated/Performance\");\nconst Screen = require(\"../living/generated/Screen\");\nconst Storage = require(\"../living/generated/Storage\");\nconst Selection = require(\"../living/generated/Selection\");\nconst reportException = require(\"../living/helpers/runtime-script-errors\");\nconst {\n  getCurrentEventHandlerValue\n} = require(\"../living/helpers/create-event-accessor.js\");\nconst {\n  fireAnEvent\n} = require(\"../living/helpers/events\");\nconst SessionHistory = require(\"../living/window/SessionHistory\");\nconst {\n  forEachMatchingSheetRuleOfElement,\n  getResolvedValue,\n  propertiesWithResolvedValueImplemented,\n  SHADOW_DOM_PSEUDO_REGEXP\n} = require(\"../living/helpers/style-rules.js\");\nconst CustomElementRegistry = require(\"../living/generated/CustomElementRegistry\");\nconst jsGlobals = require(\"./js-globals.json\");\nconst GlobalEventHandlersImpl = require(\"../living/nodes/GlobalEventHandlers-impl\").implementation;\nconst WindowEventHandlersImpl = require(\"../living/nodes/WindowEventHandlers-impl\").implementation;\nconst events = new Set([\n// GlobalEventHandlers\n\"abort\", \"autocomplete\", \"autocompleteerror\", \"blur\", \"cancel\", \"canplay\", \"canplaythrough\", \"change\", \"click\", \"close\", \"contextmenu\", \"cuechange\", \"dblclick\", \"drag\", \"dragend\", \"dragenter\", \"dragleave\", \"dragover\", \"dragstart\", \"drop\", \"durationchange\", \"emptied\", \"ended\", \"focus\", \"input\", \"invalid\", \"keydown\", \"keypress\", \"keyup\", \"load\", \"loadeddata\", \"loadedmetadata\", \"loadstart\", \"mousedown\", \"mouseenter\", \"mouseleave\", \"mousemove\", \"mouseout\", \"mouseover\", \"mouseup\", \"wheel\", \"pause\", \"play\", \"playing\", \"progress\", \"ratechange\", \"reset\", \"resize\", \"scroll\", \"securitypolicyviolation\", \"seeked\", \"seeking\", \"select\", \"sort\", \"stalled\", \"submit\", \"suspend\", \"timeupdate\", \"toggle\", \"volumechange\", \"waiting\",\n// WindowEventHandlers\n\"afterprint\", \"beforeprint\", \"hashchange\", \"languagechange\", \"message\", \"messageerror\", \"offline\", \"online\", \"pagehide\", \"pageshow\", \"popstate\", \"rejectionhandled\", \"storage\", \"unhandledrejection\", \"unload\"\n\n// \"error\" and \"beforeunload\" are added separately\n]);\nexports.createWindow = function (options) {\n  return new Window(options);\n};\nconst jsGlobalEntriesToInstall = Object.entries(jsGlobals).filter(([name]) => name in global);\n\n// TODO remove when we drop Node v10 support.\nconst anyNodeVersionQueueMicrotask = typeof queueMicrotask === \"function\" ? queueMicrotask : process.nextTick;\n\n// https://html.spec.whatwg.org/#the-window-object\nfunction setupWindow(windowInstance, {\n  runScripts\n}) {\n  if (runScripts === \"outside-only\" || runScripts === \"dangerously\") {\n    contextifyWindow(windowInstance);\n\n    // Without this, these globals will only appear to scripts running inside the context using vm.runScript; they will\n    // not appear to scripts running from the outside, including to JSDOM implementation code.\n    for (const [globalName, globalPropDesc] of jsGlobalEntriesToInstall) {\n      const propDesc = {\n        ...globalPropDesc,\n        value: vm.runInContext(globalName, windowInstance)\n      };\n      Object.defineProperty(windowInstance, globalName, propDesc);\n    }\n  } else {\n    // Without contextifying the window, none of the globals will exist. So, let's at least alias them from the Node.js\n    // context. See https://github.com/jsdom/jsdom/issues/2727 for more background and discussion.\n    for (const [globalName, globalPropDesc] of jsGlobalEntriesToInstall) {\n      const propDesc = {\n        ...globalPropDesc,\n        value: global[globalName]\n      };\n      Object.defineProperty(windowInstance, globalName, propDesc);\n    }\n  }\n  installInterfaces(windowInstance, [\"Window\"]);\n  const EventTargetConstructor = windowInstance.EventTarget;\n\n  // eslint-disable-next-line func-name-matching, func-style, no-shadow\n  const windowConstructor = function Window() {\n    throw new TypeError(\"Illegal constructor\");\n  };\n  Object.setPrototypeOf(windowConstructor, EventTargetConstructor);\n  Object.defineProperty(windowInstance, \"Window\", {\n    configurable: true,\n    writable: true,\n    value: windowConstructor\n  });\n  const windowPrototype = Object.create(EventTargetConstructor.prototype);\n  Object.defineProperties(windowPrototype, {\n    constructor: {\n      value: windowConstructor,\n      writable: true,\n      configurable: true\n    },\n    [Symbol.toStringTag]: {\n      value: \"Window\",\n      configurable: true\n    }\n  });\n  windowConstructor.prototype = windowPrototype;\n  Object.setPrototypeOf(windowInstance, windowPrototype);\n  EventTarget.setup(windowInstance, windowInstance);\n  mixin(windowInstance, WindowEventHandlersImpl.prototype);\n  mixin(windowInstance, GlobalEventHandlersImpl.prototype);\n  windowInstance._initGlobalEvents();\n  Object.defineProperty(windowInstance, \"onbeforeunload\", {\n    configurable: true,\n    enumerable: true,\n    get() {\n      return idlUtils.tryWrapperForImpl(getCurrentEventHandlerValue(this, \"beforeunload\"));\n    },\n    set(V) {\n      if (!idlUtils.isObject(V)) {\n        V = null;\n      } else {\n        V = OnBeforeUnloadEventHandlerNonNull.convert(V, {\n          context: \"Failed to set the 'onbeforeunload' property on 'Window': The provided value\"\n        });\n      }\n      this._setEventHandlerFor(\"beforeunload\", V);\n    }\n  });\n  Object.defineProperty(windowInstance, \"onerror\", {\n    configurable: true,\n    enumerable: true,\n    get() {\n      return idlUtils.tryWrapperForImpl(getCurrentEventHandlerValue(this, \"error\"));\n    },\n    set(V) {\n      if (!idlUtils.isObject(V)) {\n        V = null;\n      } else {\n        V = OnErrorEventHandlerNonNull.convert(V, {\n          context: \"Failed to set the 'onerror' property on 'Window': The provided value\"\n        });\n      }\n      this._setEventHandlerFor(\"error\", V);\n    }\n  });\n  for (const event of events) {\n    Object.defineProperty(windowInstance, `on${event}`, {\n      configurable: true,\n      enumerable: true,\n      get() {\n        return idlUtils.tryWrapperForImpl(getCurrentEventHandlerValue(this, event));\n      },\n      set(V) {\n        if (!idlUtils.isObject(V)) {\n          V = null;\n        } else {\n          V = EventHandlerNonNull.convert(V, {\n            context: `Failed to set the 'on${event}' property on 'Window': The provided value`\n          });\n        }\n        this._setEventHandlerFor(event, V);\n      }\n    });\n  }\n  windowInstance._globalObject = windowInstance;\n}\n\n// NOTE: per https://heycam.github.io/webidl/#Global, all properties on the Window object must be own-properties.\n// That is why we assign everything inside of the constructor, instead of using a shared prototype.\n// You can verify this in e.g. Firefox or Internet Explorer, which do a good job with Web IDL compliance.\nfunction Window(options) {\n  setupWindow(this, {\n    runScripts: options.runScripts\n  });\n  const rawPerformance = new RawPerformance();\n  const windowInitialized = rawPerformance.now();\n  const window = this;\n\n  // ### PRIVATE DATA PROPERTIES\n\n  this._resourceLoader = options.resourceLoader;\n\n  // vm initialization is deferred until script processing is activated\n  this._globalProxy = this;\n  Object.defineProperty(idlUtils.implForWrapper(this), idlUtils.wrapperSymbol, {\n    get: () => this._globalProxy\n  });\n\n  // List options explicitly to be clear which are passed through\n  this._document = documents.createWrapper(window, {\n    parsingMode: options.parsingMode,\n    contentType: options.contentType,\n    encoding: options.encoding,\n    cookieJar: options.cookieJar,\n    url: options.url,\n    lastModified: options.lastModified,\n    referrer: options.referrer,\n    parseOptions: options.parseOptions,\n    defaultView: this._globalProxy,\n    global: this,\n    parentOrigin: options.parentOrigin\n  }, {\n    alwaysUseDocumentClass: true\n  });\n  if (vm.isContext(window)) {\n    const documentImpl = idlUtils.implForWrapper(window._document);\n    documentImpl._defaultView = window._globalProxy = vm.runInContext(\"this\", window);\n  }\n  const documentOrigin = idlUtils.implForWrapper(this._document)._origin;\n  this._origin = documentOrigin;\n\n  // https://html.spec.whatwg.org/#session-history\n  this._sessionHistory = new SessionHistory({\n    document: idlUtils.implForWrapper(this._document),\n    url: idlUtils.implForWrapper(this._document)._URL,\n    stateObject: null\n  }, this);\n  this._virtualConsole = options.virtualConsole;\n  this._runScripts = options.runScripts;\n\n  // Set up the window as if it's a top level window.\n  // If it's not, then references will be corrected by frame/iframe code.\n  this._parent = this._top = this._globalProxy;\n  this._frameElement = null;\n\n  // This implements window.frames.length, since window.frames returns a\n  // self reference to the window object.  This value is incremented in the\n  // HTMLFrameElement implementation.\n  this._length = 0;\n\n  // https://dom.spec.whatwg.org/#window-current-event\n  this._currentEvent = undefined;\n  this._pretendToBeVisual = options.pretendToBeVisual;\n  this._storageQuota = options.storageQuota;\n\n  // Some properties (such as localStorage and sessionStorage) share data\n  // between windows in the same origin. This object is intended\n  // to contain such data.\n  if (options.commonForOrigin && options.commonForOrigin[documentOrigin]) {\n    this._commonForOrigin = options.commonForOrigin;\n  } else {\n    this._commonForOrigin = {\n      [documentOrigin]: {\n        localStorageArea: new Map(),\n        sessionStorageArea: new Map(),\n        windowsInSameOrigin: [this]\n      }\n    };\n  }\n  this._currentOriginData = this._commonForOrigin[documentOrigin];\n\n  // ### WEB STORAGE\n\n  this._localStorage = Storage.create(window, [], {\n    associatedWindow: this,\n    storageArea: this._currentOriginData.localStorageArea,\n    type: \"localStorage\",\n    url: this._document.documentURI,\n    storageQuota: this._storageQuota\n  });\n  this._sessionStorage = Storage.create(window, [], {\n    associatedWindow: this,\n    storageArea: this._currentOriginData.sessionStorageArea,\n    type: \"sessionStorage\",\n    url: this._document.documentURI,\n    storageQuota: this._storageQuota\n  });\n\n  // ### SELECTION\n\n  // https://w3c.github.io/selection-api/#dfn-selection\n  this._selection = Selection.createImpl(window);\n\n  // https://w3c.github.io/selection-api/#dom-window\n  this.getSelection = function () {\n    return window._selection;\n  };\n\n  // ### GETTERS\n\n  const locationbar = BarProp.create(window);\n  const menubar = BarProp.create(window);\n  const personalbar = BarProp.create(window);\n  const scrollbars = BarProp.create(window);\n  const statusbar = BarProp.create(window);\n  const toolbar = BarProp.create(window);\n  const external = External.create(window);\n  const navigator = Navigator.create(window, [], {\n    userAgent: this._resourceLoader._userAgent\n  });\n  const performance = Performance.create(window, [], {\n    rawPerformance\n  });\n  const screen = Screen.create(window);\n  const customElementRegistry = CustomElementRegistry.create(window);\n  define(this, {\n    get length() {\n      return window._length;\n    },\n    get window() {\n      return window._globalProxy;\n    },\n    get frameElement() {\n      return idlUtils.wrapperForImpl(window._frameElement);\n    },\n    get frames() {\n      return window._globalProxy;\n    },\n    get self() {\n      return window._globalProxy;\n    },\n    get parent() {\n      return window._parent;\n    },\n    get top() {\n      return window._top;\n    },\n    get document() {\n      return window._document;\n    },\n    get external() {\n      return external;\n    },\n    get location() {\n      return idlUtils.wrapperForImpl(idlUtils.implForWrapper(window._document)._location);\n    },\n    get history() {\n      return idlUtils.wrapperForImpl(idlUtils.implForWrapper(window._document)._history);\n    },\n    get navigator() {\n      return navigator;\n    },\n    get locationbar() {\n      return locationbar;\n    },\n    get menubar() {\n      return menubar;\n    },\n    get personalbar() {\n      return personalbar;\n    },\n    get scrollbars() {\n      return scrollbars;\n    },\n    get statusbar() {\n      return statusbar;\n    },\n    get toolbar() {\n      return toolbar;\n    },\n    get performance() {\n      return performance;\n    },\n    get screen() {\n      return screen;\n    },\n    get origin() {\n      return window._origin;\n    },\n    // The origin IDL attribute is defined with [Replaceable].\n    set origin(value) {\n      Object.defineProperty(this, \"origin\", {\n        value,\n        writable: true,\n        enumerable: true,\n        configurable: true\n      });\n    },\n    get localStorage() {\n      if (idlUtils.implForWrapper(this._document)._origin === \"null\") {\n        throw DOMException.create(window, [\"localStorage is not available for opaque origins\", \"SecurityError\"]);\n      }\n      return this._localStorage;\n    },\n    get sessionStorage() {\n      if (idlUtils.implForWrapper(this._document)._origin === \"null\") {\n        throw DOMException.create(window, [\"sessionStorage is not available for opaque origins\", \"SecurityError\"]);\n      }\n      return this._sessionStorage;\n    },\n    get customElements() {\n      return customElementRegistry;\n    },\n    get event() {\n      return window._currentEvent ? idlUtils.wrapperForImpl(window._currentEvent) : undefined;\n    },\n    set event(value) {\n      Object.defineProperty(window, \"event\", {\n        configurable: true,\n        enumerable: true,\n        writable: true,\n        value\n      });\n    }\n  });\n  namedPropertiesWindow.initializeWindow(this, this._globalProxy);\n\n  // ### METHODS\n\n  // https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#timers\n\n  // In the spec the list of active timers is a set of IDs. We make it a map of IDs to Node.js timer objects, so that\n  // we can call Node.js-side clearTimeout() when clearing, and thus allow process shutdown faster.\n  const listOfActiveTimers = new Map();\n  let latestTimerId = 0;\n  this.setTimeout = function (handler, timeout = 0, ...args) {\n    if (typeof handler !== \"function\") {\n      handler = webIDLConversions.DOMString(handler);\n    }\n    timeout = webIDLConversions.long(timeout);\n    return timerInitializationSteps(handler, timeout, args, {\n      methodContext: window,\n      repeat: false\n    });\n  };\n  this.setInterval = function (handler, timeout = 0, ...args) {\n    if (typeof handler !== \"function\") {\n      handler = webIDLConversions.DOMString(handler);\n    }\n    timeout = webIDLConversions.long(timeout);\n    return timerInitializationSteps(handler, timeout, args, {\n      methodContext: window,\n      repeat: true\n    });\n  };\n  this.clearTimeout = function (handle = 0) {\n    handle = webIDLConversions.long(handle);\n    const nodejsTimer = listOfActiveTimers.get(handle);\n    if (nodejsTimer) {\n      clearTimeout(nodejsTimer);\n      listOfActiveTimers.delete(handle);\n    }\n  };\n  this.clearInterval = function (handle = 0) {\n    handle = webIDLConversions.long(handle);\n    const nodejsTimer = listOfActiveTimers.get(handle);\n    if (nodejsTimer) {\n      // We use setTimeout() in timerInitializationSteps even for this.setInterval().\n      clearTimeout(nodejsTimer);\n      listOfActiveTimers.delete(handle);\n    }\n  };\n  function timerInitializationSteps(handler, timeout, args, {\n    methodContext,\n    repeat,\n    previousHandle\n  }) {\n    // This appears to be unspecced, but matches browser behavior for close()ed windows.\n    if (!methodContext._document) {\n      return 0;\n    }\n\n    // TODO: implement timer nesting level behavior.\n\n    const methodContextProxy = methodContext._globalProxy;\n    const handle = previousHandle !== undefined ? previousHandle : ++latestTimerId;\n    function task() {\n      if (!listOfActiveTimers.has(handle)) {\n        return;\n      }\n      try {\n        if (typeof handler === \"function\") {\n          handler.apply(methodContextProxy, args);\n        } else if (window._runScripts === \"dangerously\") {\n          vm.runInContext(handler, window, {\n            filename: window.location.href,\n            displayErrors: false\n          });\n        }\n      } catch (e) {\n        reportException(window, e, window.location.href);\n      }\n      if (listOfActiveTimers.has(handle)) {\n        if (repeat) {\n          timerInitializationSteps(handler, timeout, args, {\n            methodContext,\n            repeat: true,\n            previousHandle: handle\n          });\n        } else {\n          listOfActiveTimers.delete(handle);\n        }\n      }\n    }\n    if (timeout < 0) {\n      timeout = 0;\n    }\n    const nodejsTimer = setTimeout(task, timeout);\n    listOfActiveTimers.set(handle, nodejsTimer);\n    return handle;\n  }\n\n  // https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#microtask-queuing\n\n  this.queueMicrotask = function (callback) {\n    callback = webIDLConversions.Function(callback);\n    anyNodeVersionQueueMicrotask(() => {\n      try {\n        callback();\n      } catch (e) {\n        reportException(window, e, window.location.href);\n      }\n    });\n  };\n\n  // https://html.spec.whatwg.org/multipage/imagebitmap-and-animations.html#animation-frames\n\n  let animationFrameCallbackId = 0;\n  const mapOfAnimationFrameCallbacks = new Map();\n  let animationFrameNodejsInterval = null;\n\n  // Unlike the spec, where an animation frame happens every 60 Hz regardless, we optimize so that if there are no\n  // requestAnimationFrame() calls outstanding, we don't fire the timer. This helps us track that.\n  let numberOfOngoingAnimationFrameCallbacks = 0;\n  if (this._pretendToBeVisual) {\n    this.requestAnimationFrame = function (callback) {\n      callback = webIDLConversions.Function(callback);\n      const handle = ++animationFrameCallbackId;\n      mapOfAnimationFrameCallbacks.set(handle, callback);\n      ++numberOfOngoingAnimationFrameCallbacks;\n      if (numberOfOngoingAnimationFrameCallbacks === 1) {\n        animationFrameNodejsInterval = setInterval(() => {\n          runAnimationFrameCallbacks(rawPerformance.now() - windowInitialized);\n        }, 1000 / 60);\n      }\n      return handle;\n    };\n    this.cancelAnimationFrame = function (handle) {\n      handle = webIDLConversions[\"unsigned long\"](handle);\n      removeAnimationFrameCallback(handle);\n    };\n    function runAnimationFrameCallbacks(now) {\n      // Converting to an array is important to get a sync snapshot and thus match spec semantics.\n      const callbackHandles = [...mapOfAnimationFrameCallbacks.keys()];\n      for (const handle of callbackHandles) {\n        // This has() can be false if a callback calls cancelAnimationFrame().\n        if (mapOfAnimationFrameCallbacks.has(handle)) {\n          const callback = mapOfAnimationFrameCallbacks.get(handle);\n          removeAnimationFrameCallback(handle);\n          try {\n            callback(now);\n          } catch (e) {\n            reportException(window, e, window.location.href);\n          }\n        }\n      }\n    }\n    function removeAnimationFrameCallback(handle) {\n      if (mapOfAnimationFrameCallbacks.has(handle)) {\n        --numberOfOngoingAnimationFrameCallbacks;\n        if (numberOfOngoingAnimationFrameCallbacks === 0) {\n          clearInterval(animationFrameNodejsInterval);\n        }\n      }\n      mapOfAnimationFrameCallbacks.delete(handle);\n    }\n  }\n  function stopAllTimers() {\n    for (const nodejsTimer of listOfActiveTimers.values()) {\n      clearTimeout(nodejsTimer);\n    }\n    listOfActiveTimers.clear();\n    clearInterval(animationFrameNodejsInterval);\n  }\n  function Option(text, value, defaultSelected, selected) {\n    if (text === undefined) {\n      text = \"\";\n    }\n    text = webIDLConversions.DOMString(text);\n    if (value !== undefined) {\n      value = webIDLConversions.DOMString(value);\n    }\n    defaultSelected = webIDLConversions.boolean(defaultSelected);\n    selected = webIDLConversions.boolean(selected);\n    const option = window._document.createElement(\"option\");\n    const impl = idlUtils.implForWrapper(option);\n    if (text !== \"\") {\n      impl.text = text;\n    }\n    if (value !== undefined) {\n      impl.setAttributeNS(null, \"value\", value);\n    }\n    if (defaultSelected) {\n      impl.setAttributeNS(null, \"selected\", \"\");\n    }\n    impl._selectedness = selected;\n    return option;\n  }\n  Object.defineProperty(Option, \"prototype\", {\n    value: this.HTMLOptionElement.prototype,\n    configurable: false,\n    enumerable: false,\n    writable: false\n  });\n  Object.defineProperty(window, \"Option\", {\n    value: Option,\n    configurable: true,\n    enumerable: false,\n    writable: true\n  });\n  function Image(...args) {\n    const img = window._document.createElement(\"img\");\n    const impl = idlUtils.implForWrapper(img);\n    if (args.length > 0) {\n      impl.setAttributeNS(null, \"width\", String(args[0]));\n    }\n    if (args.length > 1) {\n      impl.setAttributeNS(null, \"height\", String(args[1]));\n    }\n    return img;\n  }\n  Object.defineProperty(Image, \"prototype\", {\n    value: this.HTMLImageElement.prototype,\n    configurable: false,\n    enumerable: false,\n    writable: false\n  });\n  Object.defineProperty(window, \"Image\", {\n    value: Image,\n    configurable: true,\n    enumerable: false,\n    writable: true\n  });\n  function Audio(src) {\n    const audio = window._document.createElement(\"audio\");\n    const impl = idlUtils.implForWrapper(audio);\n    impl.setAttributeNS(null, \"preload\", \"auto\");\n    if (src !== undefined) {\n      impl.setAttributeNS(null, \"src\", String(src));\n    }\n    return audio;\n  }\n  Object.defineProperty(Audio, \"prototype\", {\n    value: this.HTMLAudioElement.prototype,\n    configurable: false,\n    enumerable: false,\n    writable: false\n  });\n  Object.defineProperty(window, \"Audio\", {\n    value: Audio,\n    configurable: true,\n    enumerable: false,\n    writable: true\n  });\n  this.postMessage = postMessage(window);\n  this.atob = function (str) {\n    const result = atob(str);\n    if (result === null) {\n      throw DOMException.create(window, [\"The string to be decoded contains invalid characters.\", \"InvalidCharacterError\"]);\n    }\n    return result;\n  };\n  this.btoa = function (str) {\n    const result = btoa(str);\n    if (result === null) {\n      throw DOMException.create(window, [\"The string to be encoded contains invalid characters.\", \"InvalidCharacterError\"]);\n    }\n    return result;\n  };\n  this.stop = function () {\n    const manager = idlUtils.implForWrapper(this._document)._requestManager;\n    if (manager) {\n      manager.close();\n    }\n  };\n  this.close = function () {\n    // Recursively close child frame windows, then ourselves (depth-first).\n    for (let i = 0; i < this.length; ++i) {\n      this[i].close();\n    }\n\n    // Clear out all listeners. Any in-flight or upcoming events should not get delivered.\n    idlUtils.implForWrapper(this)._eventListeners = Object.create(null);\n    if (this._document) {\n      if (this._document.body) {\n        this._document.body.innerHTML = \"\";\n      }\n      if (this._document.close) {\n        // It's especially important to clear out the listeners here because document.close() causes a \"load\" event to\n        // fire.\n        idlUtils.implForWrapper(this._document)._eventListeners = Object.create(null);\n        this._document.close();\n      }\n      const doc = idlUtils.implForWrapper(this._document);\n      if (doc._requestManager) {\n        doc._requestManager.close();\n      }\n      delete this._document;\n    }\n    stopAllTimers();\n    WebSocketImpl.cleanUpWindow(this);\n  };\n  this.getComputedStyle = function (elt, pseudoElt = undefined) {\n    elt = Element.convert(elt);\n    if (pseudoElt !== undefined && pseudoElt !== null) {\n      pseudoElt = webIDLConversions.DOMString(pseudoElt);\n    }\n    if (pseudoElt !== undefined && pseudoElt !== null && pseudoElt !== \"\") {\n      // TODO: Parse pseudoElt\n\n      if (SHADOW_DOM_PSEUDO_REGEXP.test(pseudoElt)) {\n        throw new TypeError(\"Tried to get the computed style of a Shadow DOM pseudo-element.\");\n      }\n      notImplemented(\"window.computedStyle(elt, pseudoElt)\", this);\n    }\n    const declaration = new CSSStyleDeclaration();\n    const {\n      forEach\n    } = Array.prototype;\n    const {\n      style\n    } = elt;\n    forEachMatchingSheetRuleOfElement(elt, rule => {\n      forEach.call(rule.style, property => {\n        declaration.setProperty(property, rule.style.getPropertyValue(property), rule.style.getPropertyPriority(property));\n      });\n    });\n\n    // https://drafts.csswg.org/cssom/#dom-window-getcomputedstyle\n    const declarations = Object.keys(propertiesWithResolvedValueImplemented);\n    forEach.call(declarations, property => {\n      declaration.setProperty(property, getResolvedValue(elt, property));\n    });\n    forEach.call(style, property => {\n      declaration.setProperty(property, style.getPropertyValue(property), style.getPropertyPriority(property));\n    });\n    return declaration;\n  };\n  this.getSelection = function () {\n    return window._document.getSelection();\n  };\n\n  // The captureEvents() and releaseEvents() methods must do nothing\n  this.captureEvents = function () {};\n  this.releaseEvents = function () {};\n\n  // ### PUBLIC DATA PROPERTIES (TODO: should be getters)\n\n  function wrapConsoleMethod(method) {\n    return (...args) => {\n      window._virtualConsole.emit(method, ...args);\n    };\n  }\n  this.console = {\n    assert: wrapConsoleMethod(\"assert\"),\n    clear: wrapConsoleMethod(\"clear\"),\n    count: wrapConsoleMethod(\"count\"),\n    countReset: wrapConsoleMethod(\"countReset\"),\n    debug: wrapConsoleMethod(\"debug\"),\n    dir: wrapConsoleMethod(\"dir\"),\n    dirxml: wrapConsoleMethod(\"dirxml\"),\n    error: wrapConsoleMethod(\"error\"),\n    group: wrapConsoleMethod(\"group\"),\n    groupCollapsed: wrapConsoleMethod(\"groupCollapsed\"),\n    groupEnd: wrapConsoleMethod(\"groupEnd\"),\n    info: wrapConsoleMethod(\"info\"),\n    log: wrapConsoleMethod(\"log\"),\n    table: wrapConsoleMethod(\"table\"),\n    time: wrapConsoleMethod(\"time\"),\n    timeLog: wrapConsoleMethod(\"timeLog\"),\n    timeEnd: wrapConsoleMethod(\"timeEnd\"),\n    trace: wrapConsoleMethod(\"trace\"),\n    warn: wrapConsoleMethod(\"warn\")\n  };\n  function notImplementedMethod(name) {\n    return function () {\n      notImplemented(name, window);\n    };\n  }\n  define(this, {\n    name: \"\",\n    status: \"\",\n    devicePixelRatio: 1,\n    innerWidth: 1024,\n    innerHeight: 768,\n    outerWidth: 1024,\n    outerHeight: 768,\n    pageXOffset: 0,\n    pageYOffset: 0,\n    screenX: 0,\n    screenLeft: 0,\n    screenY: 0,\n    screenTop: 0,\n    scrollX: 0,\n    scrollY: 0,\n    alert: notImplementedMethod(\"window.alert\"),\n    blur: notImplementedMethod(\"window.blur\"),\n    confirm: notImplementedMethod(\"window.confirm\"),\n    focus: notImplementedMethod(\"window.focus\"),\n    moveBy: notImplementedMethod(\"window.moveBy\"),\n    moveTo: notImplementedMethod(\"window.moveTo\"),\n    open: notImplementedMethod(\"window.open\"),\n    print: notImplementedMethod(\"window.print\"),\n    prompt: notImplementedMethod(\"window.prompt\"),\n    resizeBy: notImplementedMethod(\"window.resizeBy\"),\n    resizeTo: notImplementedMethod(\"window.resizeTo\"),\n    scroll: notImplementedMethod(\"window.scroll\"),\n    scrollBy: notImplementedMethod(\"window.scrollBy\"),\n    scrollTo: notImplementedMethod(\"window.scrollTo\")\n  });\n\n  // ### INITIALIZATION\n\n  process.nextTick(() => {\n    if (!window.document) {\n      return; // window might've been closed already\n    }\n    const documentImpl = idlUtils.implForWrapper(window._document);\n    if (window.document.readyState === \"complete\") {\n      fireAnEvent(\"load\", window, undefined, {}, documentImpl);\n    } else {\n      window.document.addEventListener(\"load\", () => {\n        fireAnEvent(\"load\", window, undefined, {}, documentImpl);\n        if (!documentImpl._pageShowingFlag) {\n          documentImpl._pageShowingFlag = true;\n          fireAnEvent(\"pageshow\", window, PageTransitionEvent, {\n            persisted: false\n          }, documentImpl);\n        }\n      });\n    }\n  });\n}\nfunction contextifyWindow(window) {\n  if (vm.isContext(window)) {\n    return;\n  }\n  vm.createContext(window);\n}","map":{"version":3,"names":["vm","require","webIDLConversions","CSSStyleDeclaration","Performance","RawPerformance","notImplemented","installInterfaces","define","mixin","Element","EventTarget","EventHandlerNonNull","OnBeforeUnloadEventHandlerNonNull","OnErrorEventHandlerNonNull","PageTransitionEvent","namedPropertiesWindow","postMessage","DOMException","btoa","atob","idlUtils","WebSocketImpl","implementation","BarProp","documents","External","Navigator","Screen","Storage","Selection","reportException","getCurrentEventHandlerValue","fireAnEvent","SessionHistory","forEachMatchingSheetRuleOfElement","getResolvedValue","propertiesWithResolvedValueImplemented","SHADOW_DOM_PSEUDO_REGEXP","CustomElementRegistry","jsGlobals","GlobalEventHandlersImpl","WindowEventHandlersImpl","events","Set","exports","createWindow","options","Window","jsGlobalEntriesToInstall","Object","entries","filter","name","global","anyNodeVersionQueueMicrotask","queueMicrotask","process","nextTick","setupWindow","windowInstance","runScripts","contextifyWindow","globalName","globalPropDesc","propDesc","value","runInContext","defineProperty","EventTargetConstructor","windowConstructor","TypeError","setPrototypeOf","configurable","writable","windowPrototype","create","prototype","defineProperties","constructor","Symbol","toStringTag","setup","_initGlobalEvents","enumerable","get","tryWrapperForImpl","set","V","isObject","convert","context","_setEventHandlerFor","event","_globalObject","rawPerformance","windowInitialized","now","window","_resourceLoader","resourceLoader","_globalProxy","implForWrapper","wrapperSymbol","_document","createWrapper","parsingMode","contentType","encoding","cookieJar","url","lastModified","referrer","parseOptions","defaultView","parentOrigin","alwaysUseDocumentClass","isContext","documentImpl","_defaultView","documentOrigin","_origin","_sessionHistory","document","_URL","stateObject","_virtualConsole","virtualConsole","_runScripts","_parent","_top","_frameElement","_length","_currentEvent","undefined","_pretendToBeVisual","pretendToBeVisual","_storageQuota","storageQuota","commonForOrigin","_commonForOrigin","localStorageArea","Map","sessionStorageArea","windowsInSameOrigin","_currentOriginData","_localStorage","associatedWindow","storageArea","type","documentURI","_sessionStorage","_selection","createImpl","getSelection","locationbar","menubar","personalbar","scrollbars","statusbar","toolbar","external","navigator","userAgent","_userAgent","performance","screen","customElementRegistry","length","frameElement","wrapperForImpl","frames","self","parent","top","location","_location","history","_history","origin","localStorage","sessionStorage","customElements","initializeWindow","listOfActiveTimers","latestTimerId","setTimeout","handler","timeout","args","DOMString","long","timerInitializationSteps","methodContext","repeat","setInterval","clearTimeout","handle","nodejsTimer","delete","clearInterval","previousHandle","methodContextProxy","task","has","apply","filename","href","displayErrors","e","callback","Function","animationFrameCallbackId","mapOfAnimationFrameCallbacks","animationFrameNodejsInterval","numberOfOngoingAnimationFrameCallbacks","requestAnimationFrame","runAnimationFrameCallbacks","cancelAnimationFrame","removeAnimationFrameCallback","callbackHandles","keys","stopAllTimers","values","clear","Option","text","defaultSelected","selected","boolean","option","createElement","impl","setAttributeNS","_selectedness","HTMLOptionElement","Image","img","String","HTMLImageElement","Audio","src","audio","HTMLAudioElement","str","result","stop","manager","_requestManager","close","i","_eventListeners","body","innerHTML","doc","cleanUpWindow","getComputedStyle","elt","pseudoElt","test","declaration","forEach","Array","style","rule","call","property","setProperty","getPropertyValue","getPropertyPriority","declarations","captureEvents","releaseEvents","wrapConsoleMethod","method","emit","console","assert","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeLog","timeEnd","trace","warn","notImplementedMethod","status","devicePixelRatio","innerWidth","innerHeight","outerWidth","outerHeight","pageXOffset","pageYOffset","screenX","screenLeft","screenY","screenTop","scrollX","scrollY","alert","blur","confirm","focus","moveBy","moveTo","open","print","prompt","resizeBy","resizeTo","scroll","scrollBy","scrollTo","readyState","addEventListener","_pageShowingFlag","persisted","createContext"],"sources":["E:/Tailieu/Nam3/FrondEnd/AppDocBao/news-reading-web/rss-feed/node_modules/jsdom/lib/jsdom/browser/Window.js"],"sourcesContent":["\"use strict\";\r\nconst vm = require(\"vm\");\r\nconst webIDLConversions = require(\"webidl-conversions\");\r\nconst { CSSStyleDeclaration } = require(\"cssstyle\");\r\nconst { Performance: RawPerformance } = require(\"w3c-hr-time\");\r\nconst notImplemented = require(\"./not-implemented\");\r\nconst { installInterfaces } = require(\"../living/interfaces\");\r\nconst { define, mixin } = require(\"../utils\");\r\nconst Element = require(\"../living/generated/Element\");\r\nconst EventTarget = require(\"../living/generated/EventTarget\");\r\nconst EventHandlerNonNull = require(\"../living/generated/EventHandlerNonNull\");\r\nconst OnBeforeUnloadEventHandlerNonNull = require(\"../living/generated/OnBeforeUnloadEventHandlerNonNull\");\r\nconst OnErrorEventHandlerNonNull = require(\"../living/generated/OnErrorEventHandlerNonNull\");\r\nconst PageTransitionEvent = require(\"../living/generated/PageTransitionEvent\");\r\nconst namedPropertiesWindow = require(\"../living/named-properties-window\");\r\nconst postMessage = require(\"../living/post-message\");\r\nconst DOMException = require(\"domexception/webidl2js-wrapper\");\r\nconst { btoa, atob } = require(\"abab\");\r\nconst idlUtils = require(\"../living/generated/utils\");\r\nconst WebSocketImpl = require(\"../living/websockets/WebSocket-impl\").implementation;\r\nconst BarProp = require(\"../living/generated/BarProp\");\r\nconst documents = require(\"../living/documents.js\");\r\nconst External = require(\"../living/generated/External\");\r\nconst Navigator = require(\"../living/generated/Navigator\");\r\nconst Performance = require(\"../living/generated/Performance\");\r\nconst Screen = require(\"../living/generated/Screen\");\r\nconst Storage = require(\"../living/generated/Storage\");\r\nconst Selection = require(\"../living/generated/Selection\");\r\nconst reportException = require(\"../living/helpers/runtime-script-errors\");\r\nconst { getCurrentEventHandlerValue } = require(\"../living/helpers/create-event-accessor.js\");\r\nconst { fireAnEvent } = require(\"../living/helpers/events\");\r\nconst SessionHistory = require(\"../living/window/SessionHistory\");\r\nconst { forEachMatchingSheetRuleOfElement, getResolvedValue, propertiesWithResolvedValueImplemented,\r\n  SHADOW_DOM_PSEUDO_REGEXP } = require(\"../living/helpers/style-rules.js\");\r\nconst CustomElementRegistry = require(\"../living/generated/CustomElementRegistry\");\r\nconst jsGlobals = require(\"./js-globals.json\");\r\n\r\nconst GlobalEventHandlersImpl = require(\"../living/nodes/GlobalEventHandlers-impl\").implementation;\r\nconst WindowEventHandlersImpl = require(\"../living/nodes/WindowEventHandlers-impl\").implementation;\r\n\r\nconst events = new Set([\r\n  // GlobalEventHandlers\r\n  \"abort\", \"autocomplete\",\r\n  \"autocompleteerror\", \"blur\",\r\n  \"cancel\", \"canplay\", \"canplaythrough\",\r\n  \"change\", \"click\",\r\n  \"close\", \"contextmenu\",\r\n  \"cuechange\", \"dblclick\",\r\n  \"drag\", \"dragend\",\r\n  \"dragenter\",\r\n  \"dragleave\", \"dragover\",\r\n  \"dragstart\", \"drop\",\r\n  \"durationchange\", \"emptied\",\r\n  \"ended\", \"focus\",\r\n  \"input\", \"invalid\",\r\n  \"keydown\", \"keypress\",\r\n  \"keyup\", \"load\", \"loadeddata\",\r\n  \"loadedmetadata\", \"loadstart\",\r\n  \"mousedown\", \"mouseenter\",\r\n  \"mouseleave\", \"mousemove\",\r\n  \"mouseout\", \"mouseover\",\r\n  \"mouseup\", \"wheel\",\r\n  \"pause\", \"play\",\r\n  \"playing\", \"progress\",\r\n  \"ratechange\", \"reset\",\r\n  \"resize\", \"scroll\",\r\n  \"securitypolicyviolation\",\r\n  \"seeked\", \"seeking\",\r\n  \"select\", \"sort\", \"stalled\",\r\n  \"submit\", \"suspend\",\r\n  \"timeupdate\", \"toggle\",\r\n  \"volumechange\", \"waiting\",\r\n\r\n  // WindowEventHandlers\r\n  \"afterprint\",\r\n  \"beforeprint\",\r\n  \"hashchange\",\r\n  \"languagechange\",\r\n  \"message\",\r\n  \"messageerror\",\r\n  \"offline\",\r\n  \"online\",\r\n  \"pagehide\",\r\n  \"pageshow\",\r\n  \"popstate\",\r\n  \"rejectionhandled\",\r\n  \"storage\",\r\n  \"unhandledrejection\",\r\n  \"unload\"\r\n\r\n  // \"error\" and \"beforeunload\" are added separately\r\n]);\r\n\r\nexports.createWindow = function (options) {\r\n  return new Window(options);\r\n};\r\n\r\nconst jsGlobalEntriesToInstall = Object.entries(jsGlobals).filter(([name]) => name in global);\r\n\r\n// TODO remove when we drop Node v10 support.\r\nconst anyNodeVersionQueueMicrotask = typeof queueMicrotask === \"function\" ? queueMicrotask : process.nextTick;\r\n\r\n// https://html.spec.whatwg.org/#the-window-object\r\nfunction setupWindow(windowInstance, { runScripts }) {\r\n  if (runScripts === \"outside-only\" || runScripts === \"dangerously\") {\r\n    contextifyWindow(windowInstance);\r\n\r\n    // Without this, these globals will only appear to scripts running inside the context using vm.runScript; they will\r\n    // not appear to scripts running from the outside, including to JSDOM implementation code.\r\n    for (const [globalName, globalPropDesc] of jsGlobalEntriesToInstall) {\r\n      const propDesc = { ...globalPropDesc, value: vm.runInContext(globalName, windowInstance) };\r\n      Object.defineProperty(windowInstance, globalName, propDesc);\r\n    }\r\n  } else {\r\n    // Without contextifying the window, none of the globals will exist. So, let's at least alias them from the Node.js\r\n    // context. See https://github.com/jsdom/jsdom/issues/2727 for more background and discussion.\r\n    for (const [globalName, globalPropDesc] of jsGlobalEntriesToInstall) {\r\n      const propDesc = { ...globalPropDesc, value: global[globalName] };\r\n      Object.defineProperty(windowInstance, globalName, propDesc);\r\n    }\r\n  }\r\n\r\n  installInterfaces(windowInstance, [\"Window\"]);\r\n\r\n  const EventTargetConstructor = windowInstance.EventTarget;\r\n\r\n  // eslint-disable-next-line func-name-matching, func-style, no-shadow\r\n  const windowConstructor = function Window() {\r\n    throw new TypeError(\"Illegal constructor\");\r\n  };\r\n  Object.setPrototypeOf(windowConstructor, EventTargetConstructor);\r\n\r\n  Object.defineProperty(windowInstance, \"Window\", {\r\n    configurable: true,\r\n    writable: true,\r\n    value: windowConstructor\r\n  });\r\n\r\n  const windowPrototype = Object.create(EventTargetConstructor.prototype);\r\n  Object.defineProperties(windowPrototype, {\r\n    constructor: {\r\n      value: windowConstructor,\r\n      writable: true,\r\n      configurable: true\r\n    },\r\n    [Symbol.toStringTag]: {\r\n      value: \"Window\",\r\n      configurable: true\r\n    }\r\n  });\r\n\r\n  windowConstructor.prototype = windowPrototype;\r\n  Object.setPrototypeOf(windowInstance, windowPrototype);\r\n\r\n  EventTarget.setup(windowInstance, windowInstance);\r\n  mixin(windowInstance, WindowEventHandlersImpl.prototype);\r\n  mixin(windowInstance, GlobalEventHandlersImpl.prototype);\r\n  windowInstance._initGlobalEvents();\r\n\r\n  Object.defineProperty(windowInstance, \"onbeforeunload\", {\r\n    configurable: true,\r\n    enumerable: true,\r\n    get() {\r\n      return idlUtils.tryWrapperForImpl(getCurrentEventHandlerValue(this, \"beforeunload\"));\r\n    },\r\n    set(V) {\r\n      if (!idlUtils.isObject(V)) {\r\n        V = null;\r\n      } else {\r\n        V = OnBeforeUnloadEventHandlerNonNull.convert(V, {\r\n          context: \"Failed to set the 'onbeforeunload' property on 'Window': The provided value\"\r\n        });\r\n      }\r\n      this._setEventHandlerFor(\"beforeunload\", V);\r\n    }\r\n  });\r\n\r\n  Object.defineProperty(windowInstance, \"onerror\", {\r\n    configurable: true,\r\n    enumerable: true,\r\n    get() {\r\n      return idlUtils.tryWrapperForImpl(getCurrentEventHandlerValue(this, \"error\"));\r\n    },\r\n    set(V) {\r\n      if (!idlUtils.isObject(V)) {\r\n        V = null;\r\n      } else {\r\n        V = OnErrorEventHandlerNonNull.convert(V, {\r\n          context: \"Failed to set the 'onerror' property on 'Window': The provided value\"\r\n        });\r\n      }\r\n      this._setEventHandlerFor(\"error\", V);\r\n    }\r\n  });\r\n\r\n  for (const event of events) {\r\n    Object.defineProperty(windowInstance, `on${event}`, {\r\n      configurable: true,\r\n      enumerable: true,\r\n      get() {\r\n        return idlUtils.tryWrapperForImpl(getCurrentEventHandlerValue(this, event));\r\n      },\r\n      set(V) {\r\n        if (!idlUtils.isObject(V)) {\r\n          V = null;\r\n        } else {\r\n          V = EventHandlerNonNull.convert(V, {\r\n            context: `Failed to set the 'on${event}' property on 'Window': The provided value`\r\n          });\r\n        }\r\n        this._setEventHandlerFor(event, V);\r\n      }\r\n    });\r\n  }\r\n\r\n  windowInstance._globalObject = windowInstance;\r\n}\r\n\r\n// NOTE: per https://heycam.github.io/webidl/#Global, all properties on the Window object must be own-properties.\r\n// That is why we assign everything inside of the constructor, instead of using a shared prototype.\r\n// You can verify this in e.g. Firefox or Internet Explorer, which do a good job with Web IDL compliance.\r\nfunction Window(options) {\r\n  setupWindow(this, { runScripts: options.runScripts });\r\n\r\n  const rawPerformance = new RawPerformance();\r\n  const windowInitialized = rawPerformance.now();\r\n\r\n  const window = this;\r\n\r\n  // ### PRIVATE DATA PROPERTIES\r\n\r\n  this._resourceLoader = options.resourceLoader;\r\n\r\n  // vm initialization is deferred until script processing is activated\r\n  this._globalProxy = this;\r\n  Object.defineProperty(idlUtils.implForWrapper(this), idlUtils.wrapperSymbol, { get: () => this._globalProxy });\r\n\r\n  // List options explicitly to be clear which are passed through\r\n  this._document = documents.createWrapper(window, {\r\n    parsingMode: options.parsingMode,\r\n    contentType: options.contentType,\r\n    encoding: options.encoding,\r\n    cookieJar: options.cookieJar,\r\n    url: options.url,\r\n    lastModified: options.lastModified,\r\n    referrer: options.referrer,\r\n    parseOptions: options.parseOptions,\r\n    defaultView: this._globalProxy,\r\n    global: this,\r\n    parentOrigin: options.parentOrigin\r\n  }, { alwaysUseDocumentClass: true });\r\n\r\n  if (vm.isContext(window)) {\r\n    const documentImpl = idlUtils.implForWrapper(window._document);\r\n    documentImpl._defaultView = window._globalProxy = vm.runInContext(\"this\", window);\r\n  }\r\n\r\n  const documentOrigin = idlUtils.implForWrapper(this._document)._origin;\r\n  this._origin = documentOrigin;\r\n\r\n  // https://html.spec.whatwg.org/#session-history\r\n  this._sessionHistory = new SessionHistory({\r\n    document: idlUtils.implForWrapper(this._document),\r\n    url: idlUtils.implForWrapper(this._document)._URL,\r\n    stateObject: null\r\n  }, this);\r\n\r\n  this._virtualConsole = options.virtualConsole;\r\n\r\n  this._runScripts = options.runScripts;\r\n\r\n  // Set up the window as if it's a top level window.\r\n  // If it's not, then references will be corrected by frame/iframe code.\r\n  this._parent = this._top = this._globalProxy;\r\n  this._frameElement = null;\r\n\r\n  // This implements window.frames.length, since window.frames returns a\r\n  // self reference to the window object.  This value is incremented in the\r\n  // HTMLFrameElement implementation.\r\n  this._length = 0;\r\n\r\n  // https://dom.spec.whatwg.org/#window-current-event\r\n  this._currentEvent = undefined;\r\n\r\n  this._pretendToBeVisual = options.pretendToBeVisual;\r\n  this._storageQuota = options.storageQuota;\r\n\r\n  // Some properties (such as localStorage and sessionStorage) share data\r\n  // between windows in the same origin. This object is intended\r\n  // to contain such data.\r\n  if (options.commonForOrigin && options.commonForOrigin[documentOrigin]) {\r\n    this._commonForOrigin = options.commonForOrigin;\r\n  } else {\r\n    this._commonForOrigin = {\r\n      [documentOrigin]: {\r\n        localStorageArea: new Map(),\r\n        sessionStorageArea: new Map(),\r\n        windowsInSameOrigin: [this]\r\n      }\r\n    };\r\n  }\r\n\r\n  this._currentOriginData = this._commonForOrigin[documentOrigin];\r\n\r\n  // ### WEB STORAGE\r\n\r\n  this._localStorage = Storage.create(window, [], {\r\n    associatedWindow: this,\r\n    storageArea: this._currentOriginData.localStorageArea,\r\n    type: \"localStorage\",\r\n    url: this._document.documentURI,\r\n    storageQuota: this._storageQuota\r\n  });\r\n  this._sessionStorage = Storage.create(window, [], {\r\n    associatedWindow: this,\r\n    storageArea: this._currentOriginData.sessionStorageArea,\r\n    type: \"sessionStorage\",\r\n    url: this._document.documentURI,\r\n    storageQuota: this._storageQuota\r\n  });\r\n\r\n  // ### SELECTION\r\n\r\n  // https://w3c.github.io/selection-api/#dfn-selection\r\n  this._selection = Selection.createImpl(window);\r\n\r\n  // https://w3c.github.io/selection-api/#dom-window\r\n  this.getSelection = function () {\r\n    return window._selection;\r\n  };\r\n\r\n  // ### GETTERS\r\n\r\n  const locationbar = BarProp.create(window);\r\n  const menubar = BarProp.create(window);\r\n  const personalbar = BarProp.create(window);\r\n  const scrollbars = BarProp.create(window);\r\n  const statusbar = BarProp.create(window);\r\n  const toolbar = BarProp.create(window);\r\n  const external = External.create(window);\r\n  const navigator = Navigator.create(window, [], { userAgent: this._resourceLoader._userAgent });\r\n  const performance = Performance.create(window, [], { rawPerformance });\r\n  const screen = Screen.create(window);\r\n  const customElementRegistry = CustomElementRegistry.create(window);\r\n\r\n  define(this, {\r\n    get length() {\r\n      return window._length;\r\n    },\r\n    get window() {\r\n      return window._globalProxy;\r\n    },\r\n    get frameElement() {\r\n      return idlUtils.wrapperForImpl(window._frameElement);\r\n    },\r\n    get frames() {\r\n      return window._globalProxy;\r\n    },\r\n    get self() {\r\n      return window._globalProxy;\r\n    },\r\n    get parent() {\r\n      return window._parent;\r\n    },\r\n    get top() {\r\n      return window._top;\r\n    },\r\n    get document() {\r\n      return window._document;\r\n    },\r\n    get external() {\r\n      return external;\r\n    },\r\n    get location() {\r\n      return idlUtils.wrapperForImpl(idlUtils.implForWrapper(window._document)._location);\r\n    },\r\n    get history() {\r\n      return idlUtils.wrapperForImpl(idlUtils.implForWrapper(window._document)._history);\r\n    },\r\n    get navigator() {\r\n      return navigator;\r\n    },\r\n    get locationbar() {\r\n      return locationbar;\r\n    },\r\n    get menubar() {\r\n      return menubar;\r\n    },\r\n    get personalbar() {\r\n      return personalbar;\r\n    },\r\n    get scrollbars() {\r\n      return scrollbars;\r\n    },\r\n    get statusbar() {\r\n      return statusbar;\r\n    },\r\n    get toolbar() {\r\n      return toolbar;\r\n    },\r\n    get performance() {\r\n      return performance;\r\n    },\r\n    get screen() {\r\n      return screen;\r\n    },\r\n    get origin() {\r\n      return window._origin;\r\n    },\r\n    // The origin IDL attribute is defined with [Replaceable].\r\n    set origin(value) {\r\n      Object.defineProperty(this, \"origin\", {\r\n        value,\r\n        writable: true,\r\n        enumerable: true,\r\n        configurable: true\r\n      });\r\n    },\r\n    get localStorage() {\r\n      if (idlUtils.implForWrapper(this._document)._origin === \"null\") {\r\n        throw DOMException.create(window, [\r\n          \"localStorage is not available for opaque origins\",\r\n          \"SecurityError\"\r\n        ]);\r\n      }\r\n\r\n      return this._localStorage;\r\n    },\r\n    get sessionStorage() {\r\n      if (idlUtils.implForWrapper(this._document)._origin === \"null\") {\r\n        throw DOMException.create(window, [\r\n          \"sessionStorage is not available for opaque origins\",\r\n          \"SecurityError\"\r\n        ]);\r\n      }\r\n\r\n      return this._sessionStorage;\r\n    },\r\n    get customElements() {\r\n      return customElementRegistry;\r\n    },\r\n    get event() {\r\n      return window._currentEvent ? idlUtils.wrapperForImpl(window._currentEvent) : undefined;\r\n    },\r\n    set event(value) {\r\n      Object.defineProperty(window, \"event\", { configurable: true, enumerable: true, writable: true, value });\r\n    }\r\n  });\r\n\r\n  namedPropertiesWindow.initializeWindow(this, this._globalProxy);\r\n\r\n  // ### METHODS\r\n\r\n  // https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#timers\r\n\r\n  // In the spec the list of active timers is a set of IDs. We make it a map of IDs to Node.js timer objects, so that\r\n  // we can call Node.js-side clearTimeout() when clearing, and thus allow process shutdown faster.\r\n  const listOfActiveTimers = new Map();\r\n  let latestTimerId = 0;\r\n\r\n  this.setTimeout = function (handler, timeout = 0, ...args) {\r\n    if (typeof handler !== \"function\") {\r\n      handler = webIDLConversions.DOMString(handler);\r\n    }\r\n    timeout = webIDLConversions.long(timeout);\r\n\r\n    return timerInitializationSteps(handler, timeout, args, { methodContext: window, repeat: false });\r\n  };\r\n  this.setInterval = function (handler, timeout = 0, ...args) {\r\n    if (typeof handler !== \"function\") {\r\n      handler = webIDLConversions.DOMString(handler);\r\n    }\r\n    timeout = webIDLConversions.long(timeout);\r\n\r\n    return timerInitializationSteps(handler, timeout, args, { methodContext: window, repeat: true });\r\n  };\r\n\r\n  this.clearTimeout = function (handle = 0) {\r\n    handle = webIDLConversions.long(handle);\r\n\r\n    const nodejsTimer = listOfActiveTimers.get(handle);\r\n    if (nodejsTimer) {\r\n      clearTimeout(nodejsTimer);\r\n      listOfActiveTimers.delete(handle);\r\n    }\r\n  };\r\n  this.clearInterval = function (handle = 0) {\r\n    handle = webIDLConversions.long(handle);\r\n\r\n    const nodejsTimer = listOfActiveTimers.get(handle);\r\n    if (nodejsTimer) {\r\n      // We use setTimeout() in timerInitializationSteps even for this.setInterval().\r\n      clearTimeout(nodejsTimer);\r\n      listOfActiveTimers.delete(handle);\r\n    }\r\n  };\r\n\r\n  function timerInitializationSteps(handler, timeout, args, { methodContext, repeat, previousHandle }) {\r\n    // This appears to be unspecced, but matches browser behavior for close()ed windows.\r\n    if (!methodContext._document) {\r\n      return 0;\r\n    }\r\n\r\n    // TODO: implement timer nesting level behavior.\r\n\r\n    const methodContextProxy = methodContext._globalProxy;\r\n    const handle = previousHandle !== undefined ? previousHandle : ++latestTimerId;\r\n\r\n    function task() {\r\n      if (!listOfActiveTimers.has(handle)) {\r\n        return;\r\n      }\r\n\r\n      try {\r\n        if (typeof handler === \"function\") {\r\n          handler.apply(methodContextProxy, args);\r\n        } else if (window._runScripts === \"dangerously\") {\r\n          vm.runInContext(handler, window, { filename: window.location.href, displayErrors: false });\r\n        }\r\n      } catch (e) {\r\n        reportException(window, e, window.location.href);\r\n      }\r\n\r\n      if (listOfActiveTimers.has(handle)) {\r\n        if (repeat) {\r\n          timerInitializationSteps(handler, timeout, args, { methodContext, repeat: true, previousHandle: handle });\r\n        } else {\r\n          listOfActiveTimers.delete(handle);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (timeout < 0) {\r\n      timeout = 0;\r\n    }\r\n\r\n    const nodejsTimer = setTimeout(task, timeout);\r\n    listOfActiveTimers.set(handle, nodejsTimer);\r\n\r\n    return handle;\r\n  }\r\n\r\n  // https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#microtask-queuing\r\n\r\n  this.queueMicrotask = function (callback) {\r\n    callback = webIDLConversions.Function(callback);\r\n\r\n    anyNodeVersionQueueMicrotask(() => {\r\n      try {\r\n        callback();\r\n      } catch (e) {\r\n        reportException(window, e, window.location.href);\r\n      }\r\n    });\r\n  };\r\n\r\n  // https://html.spec.whatwg.org/multipage/imagebitmap-and-animations.html#animation-frames\r\n\r\n  let animationFrameCallbackId = 0;\r\n  const mapOfAnimationFrameCallbacks = new Map();\r\n  let animationFrameNodejsInterval = null;\r\n\r\n  // Unlike the spec, where an animation frame happens every 60 Hz regardless, we optimize so that if there are no\r\n  // requestAnimationFrame() calls outstanding, we don't fire the timer. This helps us track that.\r\n  let numberOfOngoingAnimationFrameCallbacks = 0;\r\n\r\n  if (this._pretendToBeVisual) {\r\n    this.requestAnimationFrame = function (callback) {\r\n      callback = webIDLConversions.Function(callback);\r\n\r\n      const handle = ++animationFrameCallbackId;\r\n      mapOfAnimationFrameCallbacks.set(handle, callback);\r\n\r\n      ++numberOfOngoingAnimationFrameCallbacks;\r\n      if (numberOfOngoingAnimationFrameCallbacks === 1) {\r\n        animationFrameNodejsInterval = setInterval(() => {\r\n          runAnimationFrameCallbacks(rawPerformance.now() - windowInitialized);\r\n        }, 1000 / 60);\r\n      }\r\n\r\n      return handle;\r\n    };\r\n\r\n    this.cancelAnimationFrame = function (handle) {\r\n      handle = webIDLConversions[\"unsigned long\"](handle);\r\n\r\n      removeAnimationFrameCallback(handle);\r\n    };\r\n\r\n    function runAnimationFrameCallbacks(now) {\r\n      // Converting to an array is important to get a sync snapshot and thus match spec semantics.\r\n      const callbackHandles = [...mapOfAnimationFrameCallbacks.keys()];\r\n      for (const handle of callbackHandles) {\r\n        // This has() can be false if a callback calls cancelAnimationFrame().\r\n        if (mapOfAnimationFrameCallbacks.has(handle)) {\r\n          const callback = mapOfAnimationFrameCallbacks.get(handle);\r\n          removeAnimationFrameCallback(handle);\r\n          try {\r\n            callback(now);\r\n          } catch (e) {\r\n            reportException(window, e, window.location.href);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    function removeAnimationFrameCallback(handle) {\r\n      if (mapOfAnimationFrameCallbacks.has(handle)) {\r\n        --numberOfOngoingAnimationFrameCallbacks;\r\n        if (numberOfOngoingAnimationFrameCallbacks === 0) {\r\n          clearInterval(animationFrameNodejsInterval);\r\n        }\r\n      }\r\n\r\n      mapOfAnimationFrameCallbacks.delete(handle);\r\n    }\r\n  }\r\n\r\n  function stopAllTimers() {\r\n    for (const nodejsTimer of listOfActiveTimers.values()) {\r\n      clearTimeout(nodejsTimer);\r\n    }\r\n    listOfActiveTimers.clear();\r\n\r\n    clearInterval(animationFrameNodejsInterval);\r\n  }\r\n\r\n  function Option(text, value, defaultSelected, selected) {\r\n    if (text === undefined) {\r\n      text = \"\";\r\n    }\r\n    text = webIDLConversions.DOMString(text);\r\n\r\n    if (value !== undefined) {\r\n      value = webIDLConversions.DOMString(value);\r\n    }\r\n\r\n    defaultSelected = webIDLConversions.boolean(defaultSelected);\r\n    selected = webIDLConversions.boolean(selected);\r\n\r\n    const option = window._document.createElement(\"option\");\r\n    const impl = idlUtils.implForWrapper(option);\r\n\r\n    if (text !== \"\") {\r\n      impl.text = text;\r\n    }\r\n    if (value !== undefined) {\r\n      impl.setAttributeNS(null, \"value\", value);\r\n    }\r\n    if (defaultSelected) {\r\n      impl.setAttributeNS(null, \"selected\", \"\");\r\n    }\r\n    impl._selectedness = selected;\r\n\r\n    return option;\r\n  }\r\n  Object.defineProperty(Option, \"prototype\", {\r\n    value: this.HTMLOptionElement.prototype,\r\n    configurable: false,\r\n    enumerable: false,\r\n    writable: false\r\n  });\r\n  Object.defineProperty(window, \"Option\", {\r\n    value: Option,\r\n    configurable: true,\r\n    enumerable: false,\r\n    writable: true\r\n  });\r\n\r\n  function Image(...args) {\r\n    const img = window._document.createElement(\"img\");\r\n    const impl = idlUtils.implForWrapper(img);\r\n\r\n    if (args.length > 0) {\r\n      impl.setAttributeNS(null, \"width\", String(args[0]));\r\n    }\r\n    if (args.length > 1) {\r\n      impl.setAttributeNS(null, \"height\", String(args[1]));\r\n    }\r\n\r\n    return img;\r\n  }\r\n  Object.defineProperty(Image, \"prototype\", {\r\n    value: this.HTMLImageElement.prototype,\r\n    configurable: false,\r\n    enumerable: false,\r\n    writable: false\r\n  });\r\n  Object.defineProperty(window, \"Image\", {\r\n    value: Image,\r\n    configurable: true,\r\n    enumerable: false,\r\n    writable: true\r\n  });\r\n\r\n  function Audio(src) {\r\n    const audio = window._document.createElement(\"audio\");\r\n    const impl = idlUtils.implForWrapper(audio);\r\n    impl.setAttributeNS(null, \"preload\", \"auto\");\r\n\r\n    if (src !== undefined) {\r\n      impl.setAttributeNS(null, \"src\", String(src));\r\n    }\r\n\r\n    return audio;\r\n  }\r\n  Object.defineProperty(Audio, \"prototype\", {\r\n    value: this.HTMLAudioElement.prototype,\r\n    configurable: false,\r\n    enumerable: false,\r\n    writable: false\r\n  });\r\n  Object.defineProperty(window, \"Audio\", {\r\n    value: Audio,\r\n    configurable: true,\r\n    enumerable: false,\r\n    writable: true\r\n  });\r\n\r\n  this.postMessage = postMessage(window);\r\n\r\n  this.atob = function (str) {\r\n    const result = atob(str);\r\n    if (result === null) {\r\n      throw DOMException.create(window, [\r\n        \"The string to be decoded contains invalid characters.\",\r\n        \"InvalidCharacterError\"\r\n      ]);\r\n    }\r\n    return result;\r\n  };\r\n\r\n  this.btoa = function (str) {\r\n    const result = btoa(str);\r\n    if (result === null) {\r\n      throw DOMException.create(window, [\r\n        \"The string to be encoded contains invalid characters.\",\r\n        \"InvalidCharacterError\"\r\n      ]);\r\n    }\r\n    return result;\r\n  };\r\n\r\n  this.stop = function () {\r\n    const manager = idlUtils.implForWrapper(this._document)._requestManager;\r\n    if (manager) {\r\n      manager.close();\r\n    }\r\n  };\r\n\r\n  this.close = function () {\r\n    // Recursively close child frame windows, then ourselves (depth-first).\r\n    for (let i = 0; i < this.length; ++i) {\r\n      this[i].close();\r\n    }\r\n\r\n    // Clear out all listeners. Any in-flight or upcoming events should not get delivered.\r\n    idlUtils.implForWrapper(this)._eventListeners = Object.create(null);\r\n\r\n    if (this._document) {\r\n      if (this._document.body) {\r\n        this._document.body.innerHTML = \"\";\r\n      }\r\n\r\n      if (this._document.close) {\r\n        // It's especially important to clear out the listeners here because document.close() causes a \"load\" event to\r\n        // fire.\r\n        idlUtils.implForWrapper(this._document)._eventListeners = Object.create(null);\r\n        this._document.close();\r\n      }\r\n      const doc = idlUtils.implForWrapper(this._document);\r\n      if (doc._requestManager) {\r\n        doc._requestManager.close();\r\n      }\r\n      delete this._document;\r\n    }\r\n\r\n    stopAllTimers();\r\n    WebSocketImpl.cleanUpWindow(this);\r\n  };\r\n\r\n  this.getComputedStyle = function (elt, pseudoElt = undefined) {\r\n    elt = Element.convert(elt);\r\n    if (pseudoElt !== undefined && pseudoElt !== null) {\r\n      pseudoElt = webIDLConversions.DOMString(pseudoElt);\r\n    }\r\n\r\n    if (pseudoElt !== undefined && pseudoElt !== null && pseudoElt !== \"\") {\r\n      // TODO: Parse pseudoElt\r\n\r\n      if (SHADOW_DOM_PSEUDO_REGEXP.test(pseudoElt)) {\r\n        throw new TypeError(\"Tried to get the computed style of a Shadow DOM pseudo-element.\");\r\n      }\r\n\r\n      notImplemented(\"window.computedStyle(elt, pseudoElt)\", this);\r\n    }\r\n\r\n    const declaration = new CSSStyleDeclaration();\r\n    const { forEach } = Array.prototype;\r\n    const { style } = elt;\r\n\r\n    forEachMatchingSheetRuleOfElement(elt, rule => {\r\n      forEach.call(rule.style, property => {\r\n        declaration.setProperty(\r\n          property,\r\n          rule.style.getPropertyValue(property),\r\n          rule.style.getPropertyPriority(property)\r\n        );\r\n      });\r\n    });\r\n\r\n    // https://drafts.csswg.org/cssom/#dom-window-getcomputedstyle\r\n    const declarations = Object.keys(propertiesWithResolvedValueImplemented);\r\n    forEach.call(declarations, property => {\r\n      declaration.setProperty(property, getResolvedValue(elt, property));\r\n    });\r\n\r\n    forEach.call(style, property => {\r\n      declaration.setProperty(property, style.getPropertyValue(property), style.getPropertyPriority(property));\r\n    });\r\n\r\n    return declaration;\r\n  };\r\n\r\n  this.getSelection = function () {\r\n    return window._document.getSelection();\r\n  };\r\n\r\n  // The captureEvents() and releaseEvents() methods must do nothing\r\n  this.captureEvents = function () {};\r\n\r\n  this.releaseEvents = function () {};\r\n\r\n  // ### PUBLIC DATA PROPERTIES (TODO: should be getters)\r\n\r\n  function wrapConsoleMethod(method) {\r\n    return (...args) => {\r\n      window._virtualConsole.emit(method, ...args);\r\n    };\r\n  }\r\n\r\n  this.console = {\r\n    assert: wrapConsoleMethod(\"assert\"),\r\n    clear: wrapConsoleMethod(\"clear\"),\r\n    count: wrapConsoleMethod(\"count\"),\r\n    countReset: wrapConsoleMethod(\"countReset\"),\r\n    debug: wrapConsoleMethod(\"debug\"),\r\n    dir: wrapConsoleMethod(\"dir\"),\r\n    dirxml: wrapConsoleMethod(\"dirxml\"),\r\n    error: wrapConsoleMethod(\"error\"),\r\n    group: wrapConsoleMethod(\"group\"),\r\n    groupCollapsed: wrapConsoleMethod(\"groupCollapsed\"),\r\n    groupEnd: wrapConsoleMethod(\"groupEnd\"),\r\n    info: wrapConsoleMethod(\"info\"),\r\n    log: wrapConsoleMethod(\"log\"),\r\n    table: wrapConsoleMethod(\"table\"),\r\n    time: wrapConsoleMethod(\"time\"),\r\n    timeLog: wrapConsoleMethod(\"timeLog\"),\r\n    timeEnd: wrapConsoleMethod(\"timeEnd\"),\r\n    trace: wrapConsoleMethod(\"trace\"),\r\n    warn: wrapConsoleMethod(\"warn\")\r\n  };\r\n\r\n  function notImplementedMethod(name) {\r\n    return function () {\r\n      notImplemented(name, window);\r\n    };\r\n  }\r\n\r\n  define(this, {\r\n    name: \"\",\r\n    status: \"\",\r\n    devicePixelRatio: 1,\r\n    innerWidth: 1024,\r\n    innerHeight: 768,\r\n    outerWidth: 1024,\r\n    outerHeight: 768,\r\n    pageXOffset: 0,\r\n    pageYOffset: 0,\r\n    screenX: 0,\r\n    screenLeft: 0,\r\n    screenY: 0,\r\n    screenTop: 0,\r\n    scrollX: 0,\r\n    scrollY: 0,\r\n\r\n    alert: notImplementedMethod(\"window.alert\"),\r\n    blur: notImplementedMethod(\"window.blur\"),\r\n    confirm: notImplementedMethod(\"window.confirm\"),\r\n    focus: notImplementedMethod(\"window.focus\"),\r\n    moveBy: notImplementedMethod(\"window.moveBy\"),\r\n    moveTo: notImplementedMethod(\"window.moveTo\"),\r\n    open: notImplementedMethod(\"window.open\"),\r\n    print: notImplementedMethod(\"window.print\"),\r\n    prompt: notImplementedMethod(\"window.prompt\"),\r\n    resizeBy: notImplementedMethod(\"window.resizeBy\"),\r\n    resizeTo: notImplementedMethod(\"window.resizeTo\"),\r\n    scroll: notImplementedMethod(\"window.scroll\"),\r\n    scrollBy: notImplementedMethod(\"window.scrollBy\"),\r\n    scrollTo: notImplementedMethod(\"window.scrollTo\")\r\n  });\r\n\r\n  // ### INITIALIZATION\r\n\r\n  process.nextTick(() => {\r\n    if (!window.document) {\r\n      return; // window might've been closed already\r\n    }\r\n\r\n    const documentImpl = idlUtils.implForWrapper(window._document);\r\n\r\n    if (window.document.readyState === \"complete\") {\r\n      fireAnEvent(\"load\", window, undefined, {}, documentImpl);\r\n    } else {\r\n      window.document.addEventListener(\"load\", () => {\r\n        fireAnEvent(\"load\", window, undefined, {}, documentImpl);\r\n\r\n        if (!documentImpl._pageShowingFlag) {\r\n          documentImpl._pageShowingFlag = true;\r\n          fireAnEvent(\"pageshow\", window, PageTransitionEvent, { persisted: false }, documentImpl);\r\n        }\r\n      });\r\n    }\r\n  });\r\n}\r\n\r\nfunction contextifyWindow(window) {\r\n  if (vm.isContext(window)) {\r\n    return;\r\n  }\r\n\r\n  vm.createContext(window);\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}